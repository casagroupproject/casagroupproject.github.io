
<!DOCTYPE html>
<html lang = "en">
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <!-- <html class="no-js"> --> <!--<![endif]-->
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Night on Earth</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Google Webfonts -->
	<link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet"> 
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Theme Style -->
	<link rel="stylesheet" href="css/stylesSub.css">
	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Main JS -->
	<script src="js/main.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/87/three.min.js"></script>
<!-- 	<script src="js/OBJLoader.js"></script> -->
	<script src="js/STLLoader.js"></script>
<!-- 	<script src="js/MTLLoader.js"></script> -->
	<script src="js/OrbitControls.js"></script>
	<script src="js/processing.min.js"></script>
	
	<style>

	/** {
		background-color:black;
	}*/
		#c {
			position: fixed;
			left: 0px;
			width: 100%;
			height: 100%;
			background-color:black
		}


		.fh5co-portfolio-figure .scene {
			width: 100%;
			height: 100%;
			display:flex;
		}

		.processing{
			display:flex;
			margin: 0;
   			padding: 0;
   			outline : none;
   			width: 100%;
		}

		.title2 {
			z-index: 999;
		/*	display:flex;*/
			position: absolute;
			text-align:left;
			float:left;
			margin-top: 4em;
		}

		.whatevs {
			z-index: 998;
			position: absolute;
		/*	display:inline-block;*/
			text-align:center;
			float:right;
			margin-bottom: 5em;
			margin-right:11em;
			background:black;
		/*	padding-bottom: 10em;*/
		}

			/*** Works on common browsers ***/
		::selection {
		    background-color: #ffe371;
		    color: white;
		}

		/*** Mozilla based browsers ***/
		::-moz-selection {
		    background-color: #ffe371;
		    color: white;
		}

		/***For Other Browsers ***/
		::-o-selection {
		    background-color: #ffe371;
		    color: white;
		}

		::-ms-selection {
		    background-color: #ffe371;
		    color: white;
		}

		/*** For Webkit ***/
		::-webkit-selection {
		    background-color: #ffe371;
		    color: white;
		}

		.vl {
		    border-left: 1px solid white;
		    height: 30px;
		    padding-left: 1px;
		}


		p{
			color:white;
		}

	</style>
	</head>

	<body style="background-color:black">
		
		<canvas id="c"></canvas>

		<div id="fh5co-portfolio" style="background-color:black">
			<div class="fh5co-portfolio-item fh5co-img-right" id='london'>
				<!-- <div class="fh5co-portfolio-figure"></div> -->
				<div class="fh5co-portfolio-description">
					<h1 style='color:#f6f062'>Sleepless London</h1>
					<p>"(23:30:16) Reeeeeeally should sleep soon but I like to prank my morning self by staying up as late as possible. (02:21:53) I need a nocturnal friend who’s always up at this time, I can't sleep anymore"</p>
					<table style="width:80%">
					  <tr>
					    <td>Total population:</td>
					    <td>10,657,000</td>
					  </tr>
					    <tr>
					    <td>Average Light Density:</td>
					    <td>48 (pixel average)</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets work hours:</td>
					    <td>761</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets rest hours:</td>
					    <td>1619</td>
					  </tr>
					</table>
					Sleep Tweets on a day in May 2018:
					<canvas class='processing' data-processing-sources="./assets/london.pde"></canvas>
					<div class="whatevs"> <p style="padding-top:1em;"> <a href="index0.html">&#9664; Go back or</a><a href="index_london.html"> Explore health effects &#9658;</a> </p> </div>
					<!-- <h5> </h5> -->
				</div>
			</div>
			<div class="fh5co-portfolio-item fh5co-img-right" id='newyork'>
			<!-- <div class="fh5co-portfolio-figure"></div> -->
				<div class="fh5co-portfolio-description">
					<h1 style='color:#f6f062'>Sleepless New York City</h1>
					<p>"(23:16:22) I just saw 4 different tweets about sleep from 4 different people lol. But while we’re on the topic, I’ve been prioritizing sleep A LOT more this year, and while I feel like I get less done at night, my days are too busy to be drained/living off of caffeine."</p>
					<table style="width:80%">
					  <tr>
					    <td>Total population:</td>
					    <td>8,580,015</td>
					  </tr>
					    <tr>
					    <td>Average Light Density:</td>
					    <td>42 (pixel average)</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets work hours:</td>
					    <td>1190</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets rest hours:</td>
					    <td>1093</td>
					  </tr>
					</table>
					Sleep Tweets on a day in May 2018:
					<canvas style='padding-top: 1em;' class='processing' data-processing-sources="./assets/newyork.pde"></canvas>
					<div class="whatevs"> <p style="padding-top:1em;"> <a href="index0.html">&#9664; Go back or</a><a href="index_newyork.html"> Explore health effects &#9658;</a> </p> </div>
				</div>
			</div>
			<div class="fh5co-portfolio-item fh5co-img-right" id='tokyo'>
			<!-- 	<div class="fh5co-portfolio-figure"></div> -->
				<div class="fh5co-portfolio-description">
					<h1 style='color:#f6f062'>Sleepless Tokyo</h1>
					<p>“(19:45:47) Takamaki-san, isn’t it a little too late to still be in your sleep attire? Legend says, when you can't sleep at night, it's because you're awake in someone else's body (12:26:02) I’m finally getting sleepy. Let’s sleep y’all.”</p>
					<table style="width:80%">
					  <tr>
					    <td>Total population:</td>
					    <td>38,305,000</td>
					  </tr>
					    <tr>
					    <td>Average Light Density:</td>
					    <td>23 (pixel average)</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets work hours:</td>
					    <td>93</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets rest hours:</td>
					    <td>110</td>
					  </tr>
					</table>
					Sleep Tweets on a day in May 2018:
					<canvas class='processing' data-processing-sources="./assets/tokyo.pde"></canvas>
					<div class="whatevs"> <p style="padding-top:1em;"> <a href="index0.html">&#9664; Go back or</a><a href="index_tokyo.html"> Explore health effects &#9658;</a> </p> </div>
				</div>
			</div>
			<div class="fh5co-portfolio-item fh5co-img-right" id='sydney'>
				<!-- <div class="fh5co-portfolio-figure"></div> -->
				<div class="fh5co-portfolio-description">
					<h1 style='color:#f6f062'>Sleepless Sydney</h1>
					<p>"(22:51:06) Some people have multiple alarms because they sleep through them. I have one that doesn't even end up being used (05:20:00) Okay I’m gonna sleep it’s like 5 am lmaooo"</p>
					<table style="width:80%">
					  <tr>
					    <td>Total population:</td>
					    <td>4,626,000</td>
					  </tr>
					    <tr>
					    <td>Average Light Density:</td>
					    <td>10 (pixel average)</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets work hours:</td>
					    <td>105</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets rest hours:</td>
					    <td>131</td>
					  </tr>
					</table>
					Sleep Tweets on a day in May 2018:
					<canvas class='processing' data-processing-sources="./assets/sydney.pde"></canvas>
					<div class="whatevs"> <p style="padding-top:1em;"> <a href="index0.html">&#9664; Go back or</a><a href="index_circadian.html"> Explore health effects &#9658;</a> </p> </div>
				</div>
			</div>
			<div class="fh5co-portfolio-item fh5co-img-right" id='stockholm'>
				<!-- <div class="fh5co-portfolio-figure"></div> -->
				<div class="fh5co-portfolio-description">
					<h1 style='color:#f6f062'>Sleepless Stockholm</h1>
					<p>"(04:10:16) The stupidest thing about Sweden is that during Winter it’s dark 24/7 so I get more depressed than I already am.(13:58:47) Work,work,work for 18 hours. Guess that’s life, but now am about to go home and get some sleep."</p>
					<table style="width:80%">
					  <tr>
					    <td>Total population:</td>
					    <td>1,550,000</td>
					  </tr>
					    <tr>
					    <td>Average Light Density:</td>
					    <td>13 (pixel average)</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets work hours:</td>
					    <td>20</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets rest hours:</td>
					    <td>43</td>
					  </tr>
					</table>
					<canvas class='processing' data-processing-sources="./assets/stockholm.pde"></canvas>
					<div class="whatevs"> <p style="padding-top:1em;"> <a href="index0.html">&#9664; Go back or</a><a href="index_stockholm.html"> Explore health effects &#9658;</a> </p> </div>
				</div>
			</div>
				<div class="fh5co-portfolio-item fh5co-img-right" id='delhi'>
				<!-- <div class="fh5co-portfolio-figure"></div> -->
				<div class="fh5co-portfolio-description">
					<h1 style='color:#f6f062'>Sleepless Delhi</h1>
					<p>"(04:44:40) One cannot think well, love well, sleep well, if one has not dined well.(22:22:20) The trolls may now continue their nightly duties. For me, according to the Indian way of life, night means sleep."</p>
					<table style="width:80%">
					  <tr>
					    <td>Total population:</td>
					    <td>27,928,000</td>
					  </tr>
					    <tr>
					    <td>Average Light Density:</td>
					    <td>53 (pixel average)</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets work hours:</td>
					    <td>146</td>
					  </tr>
					    <tr>
					    <td>Sleep Tweets rest hours:</td>
					    <td>223</td>
					  </tr>
					</table>
					<canvas class='processing' data-processing-sources="./assets/delhi.pde"></canvas>
					<div class="whatevs"> <p style="padding-top:1em;"> <a href="index0.html">&#9664; Go back or</a><a href="index_delhi.html"> Explore health effects &#9658;</a> </p> </div>
				</div>
			</div>
		</div>

		<script id="template" type="notjs">
			<div class="title2">1 voxel = 5km. Total length = 750km </div>
			<div class="scene"></div>
		</script>

		<script>

			var canvas;

			var scenes = [],renderer;

			var objArr = [];

			var dens =['23','34','65','78','38','40'];

			//external geometires
			var models = {
			  model1: {
			    obj: "./assets/london.stl",
			    // mtl: "https://casagroupproject.github.io/template1/assets/Tent_Poles_01.mtl",
			    mesh: null
			  },
			  model2: {
			    obj: "./assets/ny.stl",
			    // mtl: "https://casagroupproject.github.io/template1/assets/Tent_Poles_01.mtl",
			    mesh: null
			  },
			   model3: {
			    obj: "./assets/tokyo.stl",
			    mtl: "./assets/Pirateship.mtl",
			    mesh: null
			  }, 
			  model4: {
			    obj: "./assets/sydney.stl",
			    // mtl: "https://casagroupproject.github.io/template1/assets/Tent_Poles_01.mtl",
			    mesh: null
			  },
			   model5: {
			    obj: "./assets/stockholm.stl",
			    // mtl: "https://casagroupproject.github.io/template1/assets/Tent_Poles_01.mtl",
			    mesh: null
			  },
			   model6: {
			    obj: "./assets/delhi.stl",
			    // mtl: "https://casagroupproject.github.io/template1/assets/Tent_Poles_01.mtl",
			    mesh: null
			  }
			}

			init();
			animate();

			function init() {
			  //entire screen
			  canvas = document.getElementById("c");
			  //create array of internal geometries:
			  var template = document.getElementById("template").text;
			  
			  console.log('template-text',template);

			//get all divs
			  var allElements = document.querySelectorAll('.fh5co-portfolio-item');
			  //console.log('querySelectorAll',allElements[1]);
				
			  
			  var objLoader = new THREE.STLLoader();
			  var counter = 0;

//-------------------the mighty loop-----------------------------
			  for (var _key in models) {
			    //console.log('key first', _key);

			    //(function(key){

			    let scene = new THREE.Scene();
			    scene.background = new THREE.Color('rgb(0, 0, 0)');
			    fogColor = new THREE.Color(0xf6f062);
				scene.fog = new THREE.Fog(fogColor, 0.0025, 20);

			    //add helper axes
			    // var axes = new THREE.AxisHelper(100);
    			// scene.add(axes);

				//all divs
			    let element = document.createElement("div");
			    element.className = "fh5co-portfolio-figure";

				allElements[counter].appendChild(element);
				element.innerHTML = template.replace('$', dens[counter]);
				// } else {
				// 	allElements[counter].appendChild(element);
				// 	element.innerHTML = template.replace('$', dens[counter]);
				// }

				let sceneElement = element.querySelector(".scene");
			    scene.userData.element = element.querySelector(".scene");

//-----------------------3d object to add label to --------------------------------
				let coord = [0,90];

			    //for (var i=0; i<4; i++){
			    let sphereGeo = new THREE.SphereGeometry(0.1, 0.1, 0.1);
        		let sphereMesh = new THREE.Mesh(sphereGeo);
        		var divObj = new THREE.Object3D();
        		//console.log('coordinates', coords[i][0]);

        		//sphereMesh.position.set(20, 0, 20);
        		sphereMesh.position.set(coord[0],5,coord[1]);

        
        		scene.add(sphereMesh);
				//sphereMesh.updateMatrix();


//-------------------element to add label to -----------------------------
				let divElem = document.createElement('div');
			    divElem.style.left = '102px';
			    divElem.style.top = '600px';
			    divElem.style.position = 'absolute';
			    divElem.style.color = 'white';
			    //divElem.innerHTML = '$';
			    //divElem.innerHTML = dirs[i]+'<div class="vl"></div>';
			    divElem.innerHTML = '<h8>South</h8> <div class="vl"></div>';
			    scene.userData.element.appendChild(divElem);
			    divObj.position = sphereGeo.vertices[0].clone();
			    //console.log(sphereGeo.vertices[0].clone());
			    //console.log(sphereGeo.vertices);
			    sphereMesh.add(divObj);
			        
			 	let objData = {
			            mesh: sphereMesh,
			            divElem: divElem,
			            divObj: divObj
			        };

//-------------------camera-----------------------------
			    let camera = new THREE.OrthographicCamera(
				    allElements[counter].clientWidth / -13, // frustum left plane
				    allElements[counter].clientWidth / 13, // frustum right plane.
				    allElements[counter].clientHeight / 12, // frustum top plane.
				    allElements[counter].clientHeight/ -13, // frustum bottom plane. 
				    -500, // frustum near plane.
				    500 // frustum far plane.
				);

			    //console.log('clientwidth', allElements[counter].clientWidth);
			    //console.log('clientheight', allElements[counter].clientHeight);

				camera.position.x = 80;
				camera.position.z = 80;
				camera.position.y = 50;

				scene.userData.camera = camera;


		function onCameraChange()
			{
			    //objArr.forEach(function(objData) {
			        //console.log('this gets changed objData', objData);
			        var proj = toScreenPosition(objData.divObj, camera);
			        //console.log('divObj', divObj)
			        //console.log('divelem', divElem)
			        objData.divElem.style.left = proj.x + 'px';
			        objData.divElem.style.top = proj.y + 'px';       
			        
			    //});
			}


			function toScreenPosition(obj, camera)
			{
			    
			    var vector = new THREE.Vector3();
			    
			    // TODO: need to update this when resize window
			    var widthHalf = 0.5*element.clientHeight;
			    var heightHalf = 0.5*element.clientHeight;
			    //console.log('renderer.context.canvas.height',renderer.context.canvas.height);
			    //console.log('renderer.context.canvas.height',element.clientHeight);

			    obj.updateMatrixWorld();
			    vector.setFromMatrixPosition(obj.matrixWorld);
			    vector.project(camera);
			    
			    vector.x = ( vector.x * widthHalf ) + widthHalf;
			    vector.y = - ( vector.y * heightHalf ) + heightHalf;
			    
			    return { 
			        x: vector.x,
			        y: vector.y
			    };

			}

//-------------------STL loader-----------------------------
			  objLoader.load(models[_key].obj, function ( geometry ) {

			                    // material = new THREE.MeshPhongMaterial( { color: 0xfdf894, specular: 0x111111, shininess: 200 } );
			                    //console.log('test', geometry.attributes.position.count);
			                    material = new THREE.MeshNormalMaterial();
			                    mesh = new THREE.Mesh( geometry, material );
			                    //pos1:moves to the right if positive. pos2: goes up if positive, down if neg
			                    //mesh.position.set(100, 0, 0 );
			                    //mesh.rotation.set( 0, 0, 0 );
			                    mesh.position.set(64, 0, -64);
			                    mesh.scale.set( 1, 1, 1);
			                    //mesh.position(0,0,0);

			                    mesh.castShadow = true;
			                    mesh.receiveShadow = true;

			                    scene.add( mesh );
			                    //camera.lookAt(mesh.position);
			                 //get size of object
			           var box = new THREE.Box3().setFromObject(mesh);
			      //console.log( box.min, box.max, box.getSize() );
			      //console.log(mesh.position);

			                } );

//-------------------some lights-----------------------------
			    scene.add(new THREE.HemisphereLight(0xaaaaaa, 0x444444));

			    var light = new THREE.DirectionalLight(0xffffff, 0.5);
			    light.position.set(70, 20, 0);
			    scene.add(light);
			    //console.log('scene number', scene);
			    
//-------------------controls-----------------------------
			    let controls = new THREE.OrbitControls(scene.userData.camera, scene.userData.element);
			    controls.minDistance = 2;
			    controls.maxDistance = 5;
			    controls.enablePan = true;
			    controls.enableZoom = true;
			    scene.userData.controls = controls;
			    controls.addEventListener('change', function() {
			        onCameraChange();
			        console.log('controls event listener');
			    });

			    scenes.push(scene);
			    counter ++;

			  }

//-------------------renderer-----------------------------
			  renderer = new THREE.WebGLRenderer({
			    canvas: canvas,
			    antialias: true
			  });
			  renderer.setClearColor(0xffffff, 1);
			  renderer.setPixelRatio(window.devicePixelRatio);

			}

			function updateSize() {

			  var width = canvas.clientWidth;
			  var height = canvas.clientHeight;

			  if (canvas.width !== width || canvas.height !== height) {

			    renderer.setSize(width, height, false);

			  }

			}


			function animate() {

			  render();
			  requestAnimationFrame(animate);

			}

			function render() {

			  updateSize();

			  renderer.setClearColor(0xffffff);
			  renderer.setScissorTest(false);
			  renderer.clear();

			  renderer.setClearColor(0xe0e0e0);
			  renderer.setScissorTest(true);

			  scenes.forEach(function(scene) {

			    // get the element that is a place holder for where we want to
			    // draw the scene
			    var element = scene.userData.element;

			    // get its position relative to the page's viewport
			    var rect = element.getBoundingClientRect();

			    // check if it's offscreen. If so skip it
			    if (rect.bottom < 0 || rect.top > renderer.domElement.clientHeight ||
			      rect.right < 0 || rect.left > renderer.domElement.clientWidth) {

			      return; // it's off screen

			    }

			    // set the viewport
			    var width = rect.right - rect.left;
			    var height = rect.bottom - rect.top;
			    var left = rect.left;
			    var top = rect.top;

			    renderer.setViewport(left, top, width, height);
			    renderer.setScissor(left, top, width, height);

			    var camera = scene.userData.camera;


			    renderer.render(scene, camera);

			  });

			}
	</script>
	<!-- <script src="./assets/typewriter.js"></script> -->

	
	</body>
</html>
